"use strict";(globalThis.webpackChunkadmin=globalThis.webpackChunkadmin||[]).push([[325],{7011:(e,t,a)=>{a.r(t),a.d(t,{default:()=>I});var n=a(2791);const o={Manage:"Style_Manage__lRaqb",articleAmountTag:"Style_articleAmountTag__olsA6",articleListModal:"Style_articleListModal__Md15d"};var l=a(4817),i=a(7309),s=a(7528),r=a(2084),c=a(8183);const d="Style_ArticleListModal__zwrhe";var u=a(4134),g=a(6053),m=a(184);function y(e){const{visible:t,categoryInModal:a,onOk:n,onCancel:o}=e;return(0,m.jsx)(g.Z,{title:`\u5206\u7c7b"${a?a.name:""}"\u4e0b\u7684\u6587\u7ae0`,visible:t,width:"80vw",onOk:n,onCancel:o,destroyOnClose:!0,children:(0,m.jsx)("div",{className:d,children:(0,m.jsx)(u.Z,{categoryIdFilter:a?a.id:void 0})})})}const M=n.memo(y),f="Style_ModifyModal__QXpEQ",C="Style_categoryNameInput__YmDaf";var h=a(7031);function p(e){const{visible:t,onCancel:a,onOk:n,onCategoryNameInputChange:o,categoryName:l}=e;return(0,m.jsx)(g.Z,{title:"\u7f16\u8f91\u6587\u7ae0\u5206\u7c7b",destroyOnClose:!0,visible:t,onOk:n,onCancel:a,width:"25vw",children:(0,m.jsx)("div",{className:f,children:(0,m.jsx)(h.Z,{className:C,addonBefore:"\u6587\u7ae0\u5206\u7c7b\u540d",onChange:o,value:l})})})}const v=n.memo(p);var j=a(1752),k=a(2622);const{Item:A}=l.ZP,{Meta:b}=A,{Group:x}=i.Z;const w=function(e){const{loading:t,categoryMap:a,categoryToArticleNumberMap:n,categoryIdOfArticleListModal:d,isArticleListModalVisible:u,onArticleAmountTagClick:g,onArticleListModalOk:y,onArticleListModalCancel:f,onDeleteCategoryButtonClick:C,onDeleteCategoryConfirm:h,isModifyModalVisible:p,onModifyModalOk:w,onModifyModalCancel:Z,onModifyButtonClick:O,nameOfCategoryToModify:S,onCategoryNameInputChange:_}=e,N=a.get(d);return(0,m.jsxs)("div",{className:o.Manage,children:[(0,m.jsx)(l.ZP,{loading:t,dataSource:Array.from(a.values()),bordered:!0,pagination:{position:"bottom",pageSizeOptions:["5","10","15","20"],showSizeChanger:!0,hideOnSinglePage:!0},renderItem:e=>{let{id:t,name:a}=e;return(0,m.jsxs)(A,{children:[(0,m.jsx)(b,{title:(0,m.jsx)(s.Z,{color:"blue",children:a})}),(0,m.jsxs)(s.Z,{onClick:g(t),className:o.articleAmountTag,children:["\u6587\u7ae0\uff1a",n.get(t)]}),(0,m.jsxs)(x,{size:"small",className:o.buttonWrapper,children:[(0,m.jsx)(r.Z,{title:"\u7f16\u8f91\u6587\u7ae0\u5206\u7c7b",children:(0,m.jsx)(i.Z,{type:"primary",ghost:!0,onClick:O(t),children:(0,m.jsx)(j.Z,{})})}),(0,m.jsx)(r.Z,{title:"\u5220\u9664\u6587\u7ae0\u5206\u7c7b",children:(0,m.jsx)(c.Z,{title:`\u786e\u8ba4\u5220\u9664\u6587\u7ae0\u5206\u7c7b "${a}"\uff1f`,onConfirm:h,children:(0,m.jsx)(i.Z,{danger:!0,ghost:!0,onClick:C(t),children:(0,m.jsx)(k.Z,{})})})})]})]})}}),(0,m.jsx)(M,{visible:u,categoryInModal:N,onOk:y,onCancel:f}),(0,m.jsx)(v,{visible:p,onOk:w,onCancel:Z,categoryName:S,onCategoryNameInputChange:_})]})};class Z{constructor(e,t){this.id=void 0,this.name=void 0,this.id=e,this.name=t}static from(e){return new Z(e.id,e.name)}}var O=a(3424),S=a(3085),_=a(6064);function N(){const[e,t]=(0,n.useState)(!1),[a,o]=(0,n.useState)(new Map),[l,i]=(0,n.useState)(new Map),[s,r]=(0,n.useState)(!1),[c,d]=(0,n.useState)(0),[u,g]=(0,n.useState)(!1),[y,M]=(0,n.useState)(0),[f,C]=(0,n.useState)(""),[h,p]=(0,n.useState)(0);(0,n.useEffect)((()=>{t(!0),O.l.WD.getAll().then((e=>{if(null!==e){const t=new Map;e.forEach((e=>{t.set(e.id,e)})),o(t)}})).finally((()=>t(!1)))}),[]),(0,n.useEffect)((()=>{t(!0),O.l.WD.getAllArticleAmountById().then((e=>{if(null!==e){const t=new Map;Object.keys(e).forEach((a=>{const n=Number.parseInt(a);t.set(n,e[n])})),i(t)}})).finally((()=>t(!1)))}),[]);const v=e=>{e.preventDefault(),r(!1)};return(0,m.jsx)(w,{loading:e,categoryMap:a,categoryToArticleNumberMap:l,isArticleListModalVisible:s,categoryIdOfArticleListModal:c,onArticleAmountTagClick:e=>t=>{t.preventDefault(),d(e),r(!0)},onArticleListModalOk:v,onArticleListModalCancel:v,onDeleteCategoryButtonClick:e=>()=>p(e),onDeleteCategoryConfirm:async()=>{if(0!==l.get(h))_.ZP.warning("\u4e0d\u80fd\u5220\u9664\u6709\u6587\u7ae0\u7684\u5206\u7c7b");else{t(!0);const e=await O.l.WD.deleteById(h);t(!1),null!==e&&(S.Z.success({message:"\u5220\u9664\u6587\u7ae0\u5206\u7c7b\u6210\u529f"}),o((e=>(e.delete(h),new Map(e)))),i((e=>(e.delete(h),new Map(e)))))}},isModifyModalVisible:u,onModifyModalOk:async e=>{if(e.preventDefault(),""!==f){t(!0);const e=await O.l.WD.modify(new Z(y,f));t(!1),null!==e&&(S.Z.success({message:"\u6587\u7ae0\u5206\u7c7b\u7f16\u8f91\u6210\u529f"}),o((e=>(e.get(y).name=f,new Map(e)))),g(!1))}else _.ZP.warning("\u6587\u7ae0\u5206\u7c7b\u540d\u4e0d\u80fd\u4e3a\u7a7a")},onModifyModalCancel:e=>{e.preventDefault(),g(!1)},onModifyButtonClick:e=>()=>{M(e),C(a.get(e).name),g(!0)},onCategoryNameInputChange:e=>{C(e.target.value)},nameOfCategoryToModify:f})}const I=n.memo(N)}}]);
//# sourceMappingURL=325.f9b4f45a.chunk.js.map